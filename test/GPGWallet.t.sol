// SPDX-License-Identifier: UNLICENSED
pragma solidity ^0.8.13;

import {Test, console} from "forge-std/Test.sol";
import {GPGWalletDeployer} from "src/GPGWalletDeployer.sol";
import {GPGWallet} from "src/GPGWalletImpl.sol";
import {MockGPGVerifier} from "./MockGPGVerifier.sol";

contract GPGWalletTest is Test {
    GPGWalletDeployer deployer;
    GPGWallet impl;
    address EOA = makeAddr("eoa");
    bytes8 KEY_ID = bytes8(0x1234567890abcdef);

    event GPGWalletDeployed(address wallet, uint256 amount);
    event FundsTransferred(address wallet, uint256 amount);

    function setUp() public {
        impl = new GPGWallet();
        deployer = new GPGWalletDeployer(address(impl));

        address mockVerifier = address(new MockGPGVerifier());
        vm.etch(address(0x696), mockVerifier.code);
    }

    function testDeployment(bytes8 keyId, uint256 value) public {
        vm.deal(address(this), value);

        vm.expectEmit();
        (address predicted,) = deployer.predictAddress(keyId);
        emit GPGWalletDeployed(predicted, value);

        address wallet = deployer.deploy{value: value}(keyId);
        assert(wallet.code.length > 0);
    }

    function testPredictAddress(bytes8 keyId) public {
        (address predictedBefore, bool deployedBefore) = deployer.predictAddress(keyId);
        address wallet = deployer.deploy(keyId);
        (address predictedAfter, bool deployedAfter) = deployer.predictAddress(keyId);

        assertEq(predictedBefore, wallet);
        assertEq(predictedAfter, wallet);

        assertEq(deployedBefore, false);
        assertEq(deployedAfter, true);
    }

    function testRedeployFails() public {
        uint256 amount = 100;

        address wallet = deployer.deploy(KEY_ID);
        assertEq(wallet.balance, 0);

        vm.expectRevert(bytes4(0x340630c7));
        deployer.deploy{value: amount}(KEY_ID);
    }

    function testReadKeyId(bytes8 keyId) public {
        GPGWallet wallet = GPGWallet(payable(deployer.deploy(keyId)));
        bytes32 keyIdFromWallet = wallet.keyId();
        assertEq(keyId, keyIdFromWallet);
    }

    function testReceive() public {
        address walletAddr = deployer.deploy(KEY_ID);
        (bool success,) = walletAddr.call{value: 1}("");
        require(success);
    }

    function testAddSignerAndExecute() public {
        GPGWallet wallet = GPGWallet(payable(deployer.deploy(KEY_ID)));
        wallet.addSigner(EOA, 0, 0, "", "");
        assertEq(wallet.signers(EOA), true);

        vm.deal(address(wallet), 100e18);
        assertEq(address(wallet).balance, 100e18);

        vm.prank(EOA);
        wallet.executeBySigner(EOA, 100e18, "");

        assertEq(address(wallet).balance, 0);
        assertEq(EOA.balance, 100e18);
    }

    function testWithdrawAll() public {
        GPGWallet wallet = GPGWallet(payable(deployer.deploy(KEY_ID)));

        vm.deal(address(wallet), 100e18);
        assertEq(address(wallet).balance, 100e18);

        wallet.withdrawAll(EOA, 0, 0, "", "");

        assertEq(address(wallet).balance, 0);
        assertEq(EOA.balance, 100e18);
    }

    function testExecutWithGPG() public {
        GPGWallet wallet = GPGWallet(payable(deployer.deploy(KEY_ID)));

        vm.deal(address(wallet), 100e18);
        assertEq(address(wallet).balance, 100e18);

        wallet.executeWithSig(EOA, 100e18, "", 0, 0, "", "", true);

        assertEq(address(wallet).balance, 0);
        assertEq(EOA.balance, 100e18);
    }

    function testGeneratePrecompileData() public {
        console.log(EOA);
        // to get key ids: gpg --list-keys
        bytes8 ED_KEY_ID = bytes8(0x49CEB217B43F2378);
        // bytes8 RSA_KEY_ID = bytes8(0x4C4C3AB789F86A6F);
        // bytes8 LONG_RSA_KEY_ID = bytes8(0x2314E28610109FD2);
        bytes8 SUBKEY_RSA_KEY_ID = bytes8(0x1F1336982C96D43C);

        // to get pubkey: gpg --export {key id} | xxd -p | tr -d '\n'
        // bytes memory ED_KEY =
        //     hex"9833046768354e16092b06010401da470f0101074089ea06d9820134822b9ddaeef1929c50ddfd9bbcf7c0794f3082d864fecb30feb42f5a616368204f62726f6e7420287465612d676574682d7465737429203c7a6f62726f6e7440676d61696c2e636f6d3e88930413160a003b162104c4e971386f7e24899b765c6b49ceb217b43f237805026768354e021b03050b0908070202220206150a09080b020416020301021e07021780000a091049ceb217b43f2378e65600ff538b73b85fc29fe716c0857343ac1efb4ac2864fd346de79f00d0e0f6d6e8e970100cdaf800a4ea1c9fabe8c982a191bff567c16019dad016c06e643b689ff3fd60eb838046768354e120a2b060104019755010501010740cf010ab1e65c0a4560292d4f8faaf2c03b6e115f2482464404d12bed986c8f530301080788780418160a0020162104c4e971386f7e24899b765c6b49ceb217b43f237805026768354e021b0c000a091049ceb217b43f237866a900fe2d50d10d916ced462d925220880b538cc9ab4fde817aa5bb3928d4f2a46003a50100d420071637d56defa999a22bc43bf0b0b179cf288d9643a54e98c13eb346df0a";
        // bytes memory RSA_KEY =
        //     hex"99020d04678fd745011000d6a2e19ddb1d378fdf58bd6c231dc7c5d1db60ad5aa8a6cc0c1cf2a8881adeccadbbdfa0148aa32885972d2f02033097a771c9f2b309c12aed7807b084334c1b9238458a692e819bb8a2c9ec40e5ab19055116bf4fe77b8c00f2481131c46645eaffae7ae6d767b9e3aa7eb34f446d21faabc38ec55f0f37accade05fe00e2f7e7ba97a98fb198255a4cd222964d2c0c3f129ce155692d8233f32afb016df1c72c3d9fa7c04f2ff30adebc830dcbdec77c38b2540c0b11dde2a246022ccce7e917fb9fe6b18a3a81e5a7b3be550eefd240fc87261e777e527363d4fd72e84ba6e0138903de95a2177c173f0df97858f202301021b776abb925e70b59e752a0f5b4e374cbf72ed81e8f0ce43ca3b996fc92f68d532de133f77cb2d24b91a70e7a4f9217d31581d871ee7e9107ee178b27d2a31816e845b1f7bc189df648e03a07f4886a0d332e84df9ff81857cda725f762f384ab8984ee29e5cebb676c880945ab7d54c83b92a0dec87d790320e10198c62cd68cc78273b198347d5532c5f4bf14a8c761e81ae97f66f57f0782d6a3d426b482ef93dec7fc3b7f4d08f526a4dc660f19399ec0a1debea7538b900b74d913164f75df383b9a2bfc3b3e526dded8d6bd505e3a68f41629dbc8473d49e2bafa1730aafd71c92284de7563141cc58f2fdcd1815f903ed315ad1483aad5682ef8e88cf21f034c47d92d40ab8398904b0011010001b41f5a616368204f62726f6e74203c7a6f62726f6e7440676d61696c2e636f6d3e89025104130108003b162104fd22037dffd75189a0399b084c4c3ab789f86a6f0502678fd745021b03050b0908070202220206150a09080b020416020301021e07021780000a09104c4c3ab789f86a6fc4050ffe3c79d78ca987329fb699647ef2d7991bcdf42f467fe9532657e7b409dab1032ae96dbcf4315bfa096c5bd4161be10f57e679276ae9e10eb02bed8f5c39a548f695a4f96347de201bb4882d731149c783aa7b0ec4ab92ff595c64527ff86cb9132ea0ec2df6e2170239523639ad4665b0ed48d5dec9967895517f54797d3d8f5c12c952e38cd2002e699d0bdf587b048d75371be233684710c1f06b854d46f18c6308d7b6e1a3230afd2856599c594f50434464541b0e6306d7afdfcaa127832525e65d67f1bb4192ed47fe3c0275fbbc8bf2d73997b12d4ef1c18cd63ca571bf73d6e71e971c5f018acb537ac4d2e4fcdb39de9e78cd1b8a140b9ce703452c6d5c569e25a83b5e9bdd2e3d314557f02b45ff2d3b933d2a5610d14b6f670aeac1c3b75be559bc800533120296fa467297f5c84edcfae1dd34cffce6802e47c7baf1b4a4264768fda65166f7b88bc412144710a849cce0759adbae21aef5f7340933877a42408132f24e37f593fe2ee29287a36bfbef83e5ef028e51958ac55996372a1e5b02ed02b63bfd60bd40af8c9728d3a2527102a9d6b872afbaaf0c4273009496aea5868957b9d37727f57610943491ab96a542aa0387de7796fff0d64aa73fa0d272a79b1543dfdf1f063413b0326a9b90065e3a45a03768cf60b49a9453171a8478b5faea86014ebd43f70253584acc3a83389b964dcbbc7a768d9d8fb9020d04678fd745011000d9b191215c1834fadd6eb0ee86470444ce08a8606fc91bb51507ce634364190116a0eaed2771d22b96b7d5b20b784e49b1ea5d341950c14bacc6b2e62df8d150cdeff991075204ab6014315868551237c247d33cf0d2e66e72ae3c0d173fede1ed7a59c63a1e9d80bbc04de79304625cd05748c0bb773879450e1a7c663838bdb56465ff417cf9c97aa801698baa0bb2a098b24923322dc1e42c34cc8ec3dcd2fda39b43294bc0a91be1c7772b8d71547cc4755d793d2f4c3dfb1abea9ea45a8b9899e2ab763392cf84d5f462adabf9f2a0d9c87db537702aaacbb445a2a91e43b6e5c02b8d877f340434115997846b7a3ae419f1307a2cbcf9c0c85c7733dae540c746ea62aef40493aa1b7b581e7f9e6b63cdfaf8847003429c1bf1e5733a1ec38be7a360f98053b86e43efe1de87735924f5fdf6b4718ef4203d80901039818fad0e68fd435536fde8d569d6c262b571e8e224c959225146b6dfee2734a23122a420bf2f6624b53cc7582e07d0ec1483fb6256bcc2367681ec8ce93ea685bdd3f4539e3e7ef19cfe95dcd23c5c9bc004a9517bbf8142febb02b1f6415e37361b1a3bf0a1f2b47edb1e5457cabe93e71ac97b50ab48a2d276b2ff6e4a13d4a7204ff3f0d36275f0952300f7d88557a74a92ff3c573cc57a419dfb3ad7d0767fee980db6bb1af84573a048a6e1ec7a88b98a8655f7a62a190fa5fb75dfee6070011010001890236041801080020162104fd22037dffd75189a0399b084c4c3ab789f86a6f0502678fd745021b0c000a09104c4c3ab789f86a6fd6101000b5248d88e035b6d0c18777f98e11451dc37cc441840038968ce3d50f183be21056a65f57486ae6b0d23723a70e4beb2e1f9424cd5400936e9398e0193098b39219e183c9d58e333119f9d0d84c376285807e98e3b80501dbf9636b0a05c5150c8086ee4cd5c5c9dae504bebcb0210f394b3daa5962981c7d48036811d2957b02acfdc04d39cb4b3f035969386d547f96f751baa1949b09e4420b4788bd50e270233c58ba61cb5ab63b4ef85ce9f35e183175b1892f506f905944b425e22697cdcde93c20307537ca2e651469f3240dd642e6062952b7bbf4b7c6a57d0b8de20fba9e2fce7cd1c664d529a1a2adb660c4ac696f9c3cdec6018931639ceb314c703e3391ec9e2b65ffba440126b6b2f17c3f98d3c97c5a57f3792e2df940ab6b30da3d51d8daf25a56d1df8026bd38da903849d0dfb654d7e35e46f0a493a3815e03e3bb4070574eda87f39672b198699ead436dacb2cd3a9e45dfaacc051c517267054202458d944932ec9c3845555ae31748bd29967112f9b6768c300e9a566aa0f337510e7fbd94edaa8fbc18f7095bc16847e0cf8be26b805ac9e3a8c33d278b1baee4e6857fcbdaf85744a4914605df28ee4a0d5495af7a604127a9e8b04411999e10926338073c9d4a9bfa89f2bf4e6bd3a3a7319fb788e0551d4be38a38dbcf0767d398ec3d232995b2f814713a12be50409c0a5dcf25a450f0954da453";
        // bytes memory LONG_RSA_KEY = hex"99020d0467a53381011000ab17fc416bf19fa6ab71f5e5293bafffa63592fb13e7d470443d8101e9bb0e821859462aa91491a557871f9f606b1e40eaaf669f2c99cd5a2fa099e3f9b72d64fd6a9337c5297654f2f5a4d068c36c0d0ccabe5d612847557b89e9633fe5ae9a6849f286208be4f4a739a2b39fe7a50e625ae783d88f900fec4c68d4f58539c17d90327240787ae680fb37a5cc6cc84d14728d8c4645433dfd9ded15730c85472e9a5c20d61bb9229badd4c12763f172610273e51a3602da9e4f7088e1650df1b5a649467cb0cf8690899832b60b5957ac677b44a091ad8c33c47891c963d681b002edc4e662157788bf119245b1df75e5b85ff2a4907b06cb86c83c166ac797e8bf9574c5ee28e7564db510ad5d5fdbd3b4c2e6f14d500962c8a2cadd0edd30b75e00a5343e6b30e5af684ff1bb150cab02b6712d400a81a3e74aa4dfcb05aa8b6eb579f35dd37fde915dad3726da3567f2cf7137aea3400f43cc95c7498feb952f91bda4363dec27953bf998dc35dd41d7f9f2cc6a9035250a4d386aa59c2a7b91a5e82b1d5cec5576ff61d3595838360652a328b69f5876613494ed095a35d61ec13e8d3c34b6ae9e99e7cb440050b00f4140396a3b8b79196069a89b0ed930971cc11d331e10b85396fd081b871d8b7cbdeb2f5ba5c93e9485cd82ecedaa42d9261985f43f7224e4345e19f2276b4c623d1943d59cb64d60a772ff28cda30011010001b420457870656e7369766533203c657870656e736976653340746573742e636f6d3e89025104130108003b162104ac211461fd9114a19e365d4b2314e28610109fd2050267a533c7021b03050b0908070202220206150a09080b020416020301021e07021780000a09102314e28610109fd214781000859416bb8d8cdd986b7b9cf5a55d8700c1bafd7d9b7f7997e299cd83c3e39b475c0c3d9d9dfc98f6189a42a82cc69058221ab1dd2a61ccab1a9b6285dce5316bc315d5f889c4472d90590fa8f358802e395e6879f27cc0a054fdf34012811f38ccd246aa579a190b09230826a2fbc4317331e4c9b94761575601801a2f7652f60b2ca0c457dcb8e610928029975c60151f70f8c21309612c718ff21c0c095d7c7ead082f803213deb552d7207c622aefa5cbc03d96b8a7f116fb90f6ded175d619b666aae975f750515867c093760560dd1bed4e327b9dfe6503e2cfd2f1f01f3354a63994ad4a6dfbf280feabefc538004c0524afd4fb07c5e69bb2b63ea6088dd938f903f29b2b2bfef30e063c95b70acd379da9a4c9c007afe03e99aee4c4e42102d00d6e488a245764df5d332a9856ff50e813d673ee216cb04c15c6c92bdcadeae38ef93c628573091262500813e6f72f2fb726e7b5dcfd90de85f1e2d5a76f0766fb47027385d99f513803731a87676db71376420f8dc65c6d9a45b7b6f6a68cfe922b04fada01d9e238823b29b3e19164fe8ae13bc94a0f2b6303d514738aab9ebccae8870c28ed64580a55c99fab61ebbf809dfd34065e6cc7e63d0d984830ca54780f6b727ad1937b20f3e25f658f07aa5e6c226c8bb99041d7aeb9b44a86e704a3777f227d833dd071313400c7a93cecb8cac58185dbb5382c83c3b50107457870656e7369766520285468697320697320612076657279206c6f6e6720636f6d6d656e742e205468697320697320612076657279206c6f6e6720636f6d6d656e742e205468697320697320612076657279206c6f6e6720636f6d6d656e742e205468697320697320612076657279206c6f6e6720636f6d6d656e742e205468697320697320612076657279206c6f6e6720636f6d6d656e742e205468697320697320612076657279206c6f6e6720636f6d6d656e742e5468697320697320612076657279206c6f6e6720636f6d6d656e742e205468697320697320612076657279206c6f6e6720636f6d6d656e742e29203c657870656e7369766540746573742e636f6d3e89025104130108003b162104ac211461fd9114a19e365d4b2314e28610109fd2050267a53381021b03050b0908070202220206150a09080b020416020301021e07021780000a09102314e28610109fd26c78100086998f51bbea19b99e237510eba679d806a70b64e6a4d8b3a19794bddd2318c399fcc00f6ae5cb8ef1e085d569d66cd56097260e8979264f7f2f7f7571539b8b77d6f351b06d106a48a044fbb6ffc6abcf4ae2d84e1a37df0be701c73b176b34dbc23001d9b22bed4e76cd26d5c6da6eec67d3d8dcdc2a58878f7ab2e98740938aca9f2cba41a38a00202bfa85b668d694705206aedeb8461186df522163f4c2b8b747c174fe4a63bb062d46a411ec793c9466d0b0d15a33edd6fa4e786d2418e8b6fda3cc9f06f691bb5cc84acac0816dc93460cfa032736e284729a0c6b381b9c3798d915e116b21ad8372ab82f262f5aef02486e458fb75cc6a155aee3e14641fefbaa9a6c42808b957ef8476e8b5511d61e35dbb3e368c4da3a28664039640c9363dee04c26724e3eef387f131102760fc03ea48ed5120b15a84801bbd7a49ecf8e5000661fc492ceb0e6c5941a9a62e87aa30f40a44e34738f7f168e14807bd157d05d48eaf1a8ea2429cb9d0db1001d51c6b17ac69299075358e426fded5b76e00ba11a18474beabc8dc36b39de3d8dc268186c1e0d1b9b3b8269d96b28403b7f12914ccae8c16ec8fc1ec1bf9cc4b126c155e4c611a8e793f9c4db385a7b5639eae03aedd0334dad3c2e5e0bb3e52da42cca098b0645f8c9bd9fc36d4e80691d3b5f703211a391d8d1ecaeefaa0bb49541d60f26603279b56f9eb43c9b420457870656e7369766532203c657870656e736976653240746573742e636f6d3e89025104130108003b162104ac211461fd9114a19e365d4b2314e28610109fd2050267a533b1021b03050b0908070202220206150a09080b020416020301021e07021780000a09102314e28610109fd2a8640fff55034659e098221ea89657402aef0becb15d142e50c3d52dbe1148a1d4b4365e3732b4fcc3514f4be5977549517db9e353eb6c5331118c4d24be1556279dd3d723ebc0809398349b8505f370ce15635aa4f90ead38057f59075598b12a06981ad113a32a7986cd3c6e736e39c13fd8dbc0cedf48b2dc3b532d04a2cd34ffb95cf862914281ef9c66b86e95cdb38fe262730eb1ffe6934c0c3dee4381dfed533bb9315296b4b87d74b18afd64d1187d95628bc2d410080cf35b047bd0aa9747a8dc7e364293e2cde6a1e42e796b66dbed413087327532b851e4b69488703798ac9c270511931b6cd0ac1a7f58eacf8bd12de279ce9c43fd8279e4e3dcc0f37622cf5a5e3a0b9ae15b491165fb981378e19c9d72c7c4dbacae2efdbb160900cae13319fa75ebfd1fb109646197db087f3d5f3fdf7b4b0e719ddb18982ba361e688eaca543ba7ed1a9904fd90d803480c6a38165793573029ed7c500e857352488322941b2ae7f3f78bd979f356f99378e90c4b138f3e4236e0269b8d6f255c7f3c706fde7ff82589bd7064519f2334d9359178f2bf4914194d01e2b0e0004a78f696339ff4d37fac00ef51ed939b28dce26b9356407ce754ce69e5ce2c92fa987ff004ec5fe377dd35ee5c637c283a8d6c3687b87c0dac618a9de7dea51032f92741166f30382b96e071a8628ed0085b120013e07204ddd6b5b9f05545c78930cfb9020d0467a53381011000e9c23108aa2e37dba07f7e3fa5dd6a39e88ee8da12b6ff443452dca14cfb45862faba67f9632416dbce4307cd8ff47bdfd03f050c67015491c2d266f09e4fe9d4fbcf8d8e38830352ba3532f9e70fe6f0fc1658a7da4720813e4ae22997d3c65420cf82f333ddffcb6c6e66de46b5785c196dbe06fb129e81b3326cf2cf85f883fb10e2b1f37d346a85b74b066b3a41bb332cd3dd960d496072e48727d69606ae927075084c18f7c7bef70c4c5eaad16723dd30dd6734c677020d5c9a08752f2c27c742e0219d07cdb784a3d1376a029fd292bb781b1b033e57b07b28ba4b7b21623832f2988e9df35de68c242594e4871c5fec62e0b5ca98a8da839dd5aed0d1317559144743e4083e98c85a80a947a0466ab79a10324905a63dec6cc98e44b858f117640565ba09159c96db96c97f10ddeb50543039affca3428b32c68c8080f0d3265251456d44bfe4c5e299680cbb2597318f63a8b556e2d1c006752586a6359e213787c8441c5c97c6ee5e3feec8781e1612ad6228b90ed4b68b3c60d0191174d093d909336a1897ebf907ed27730f300384711dabc35c79fde2cb7a72a89e776b42128343a00222bbd77c41b67018bbaf2f2f6e6c9deb4c17e25f142d6a750e1f3bd5ddd4c62da97bb82ca5aecdc119d6f384f99e8efe9102d99b0837e8315d0305e6a52d7c03df412da6cf68f07f865f1c5fe2d3a29355b411190cbd70011010001890236041801080020162104ac211461fd9114a19e365d4b2314e28610109fd2050267a53381021b0c000a09102314e28610109fd27a0110009dcfaf369119fbede26a181cf868b291aea61543e5e4b9b6504707f5804cce09f3795fd5071232d795df49f90409fecc3177b55b7a07eb9840d667362d8ccb1f227df7f7f6a7e8c49d9cd058543c71a468eb78cd5512b5f9df800f5544450eea56a4df95f6451167fd02883bb00ba39ccbcc4511aaa9815e07ac122684d626dcf43b38485bb8e18e805714d3a5d1043aa160cd881f9a290e957ad32656e0507698ead9f6f21941a3715236ef62c69a5fc78ba0777666499ffe857ecacbcce78aac9013fd9167da0d3196b0ce33687c16b2ed1bc09a38f0cbd6ec94be81d427146e2661149696d372f087f6cc476ed7e2ceb48a0e31da2ce4026cd09e1cb768cd0efc02ba1dfe7f35c4841c1c8cad46d2fbea88f8866815d00e99ad7361de620e0fc0ed0e5cf8b4ce361b3db74dac5674d449af65bdd10efd08d6ac3f652f74eee6dae4a4bb89cd6ae2e597a88f17fcc5d118a8c6cf12ea63ca54e9ec0b7dce0abd9690aca0fef564421fcbb2836c96ee2cdb1091b66ede3e0c81f2e8a4d44e5c8d7ebf7468c247c9ff0424a395cdade73754415e16ad8adf341bd54f3ad580ebf46f069134430450de893c9f00b250758feb9f27c3c2629072e007d47d202f443e4a2d1db525fe0f6e58dbd1fc60e8fa23a3389664463805736bc7d3469dc7f3d54e4ffcae33f45ea5720d26b6674b27e18615d0fbf49f5ff12e03ba1c9b011eb9020d0467a533dc011000c54246d9fbce7a90dfef59c4bd3c79bdaa9c183c06ebda8780c22a6ed8c86c75df89ad8acf59329ed54da9166ffd23ffffed4403cca08e97e6865f6e259b46bf0d3783f52e087197265258b9166a08303cc873e199aa274159011ad9b6325f34e231fa634100ca5b6d7ddbe7ba931e041fa99e78332e36831915bc798f068555e0812dfe305c92c4758a2fd6c5512d7b58c8f4fbe07837c16feb797e339b8148f1bf0d8308b6a2d0e4261d8c7b307b50df1665f8970fe815ade81abeffb0f5f20bcdc061997187e5a46f552638c762b8bcd0a0252bd4d10b0a3a5a86e1cb9058fe4a0c424db3b0ff43495ea9c6fa271b861b77b03bb31254f5c7b4d06a15b06dee5d31d5cd48ea154f476a8e23ab94c70bc78625938a1d43e13d050c14b2e171678573269ea8f21576723bebf4ae9c17bcbcd7c25017a0abf51ba0c75cf600f847fa4c95cd7b30b6b4d4eeac093f8b31087235ccd974c939920332e9dd7bbaa874fe0f7531c2dd4c2b88ed37654e0ccacb351b75b0408d09e9b4ece4532d6ba6f1d6c4bb5c20a4c7c0e31823499e029ba9a4066ceaab4eee94358ad5b625086248bc1b56e149861b4b8f43e540ca0bf381eaabe604f2212eab455f124eb73dceda166b1ec7830fb442015580132c89dec33da8d9b6186a6922900318fba406a19821f914f36def349d0e1d93a7e4a3e6e469062798f700b13bc00e6089832ee7001101000189046c041801080020162104ac211461fd9114a19e365d4b2314e28610109fd2050267a533dc021b02024009102314e28610109fd2c1742004190108001d162104d0b91970b73e53974995dac153fda2d6aeb31fb0050267a533dc000a091053fda2d6aeb31fb00c7e0fff6b3a769caeec11abc1db7cc9625f630120688afc620a2fdecedfe52b7ddac5a3d9041864f5a1c794643befe36b132f69a1614a420b79c165e48de0e9be162ff32311dcb889a614c94f496439d291218d272d0a01e183a79baa7e9c69a8bd710200e34aad4698f09e450baac30ac37b78f14e7503fc533bd9d2e2f9dff8e5b5521410863bf4fe5737be2dbb4395f933a5eef78bbd211499bb3bc43ccc619a52353a9d83c082b7e35eafaa481d7f3af234188d2e96757e9153e08a228baf066465ef40bd9c865c12d531e0ca1220d15cf75462e032203cd615148363701583bc308539f355ede21511cd4edd55cc00ee0d94057764414a47040a811863aa999f9ef3adff2b50a63f09af0c633a7caa4ffb367d8d9042623160c579df025503ed1c86140cc642d9637ebc3da8e8fbbce7690fb73383c79f41f3a495ee81acbd7d7780638d88889ca3ec8d87ecd1e1b44665defd76969039d7d65c7afc03b8b48a44dfc6d9376294a5a42e6bc6d98c9c088e583d6a3ceafe452bb3caea8ef1849b97c42ba7313a8e59731cbb9cfaedc6ea753168ca106ac86d99db8f2439bbf0088cf066263c080f9daf7af79f716301275d9a4689caa882a34f58fcbe9f85206f999f8ac1db88bcdee3b16a6dee9720150627ad084a749beaf65844a6fc9e770ff3545061236bb0c8b6d4529d2530c997f0760f58159358ecf057b13f0400b83609a19c0fff6ec3e9f7f2ce29ca5a654529849df1a2fe7737cfa496df9519ffe5ce038ee0641bdaf5db0a233df4d3b686ab471b17fecaee186644da20c879ecfd879c203043bdb6c20cb3cff8860d0bd2bba5a8a1034e9e84f561ab6124684e68c1e74ca754dd121815c8981c56cd524fe19265b07b56d400ef8a96a68835133bd9b85fcd9641db1aa2d72a0e1d6ceba4dc42cd65b7b274c8462396738c2ff99a5a64e5b0c2c3495833e0add2382d44b4a66d686c212bf0d11ac2fe614a3d6f9cabd0e11ca9ffcf1461b201403da7cadbb981f783c20254380ecd7e0b4dae36178548b2b0ce12e7b0caff73efce2ef505647e13f2a4397696f893a7f68fab836d4ca29a8317299a3feba20c3fa3d3b5e6c6399686575f8395f9cb0c3b3a5e8463e85a1b3ad9b70ff6747eeec1ea0144292efc1a4d98c435261fd9f7670be658a6a71c48f3f90e9094eb99c265fb58668cf619f2288f23869e641c8a26783274e07ef162d65aafe9b65b1993fe470f40d64849b6dea2447a9421991ce884746e8b9b9383ecab05d3e8723dadd2229270933f56fd4348ee7422dd86d142a3b2520f45e84c760b51216c5a11bb5a1daa5d50523c6aa4e76fbf0ecb918fa2d013b6cae8212f5f66b01f71166c6e9328d449ad6bffd45a99c830615e51e2a1a1c50a33b5ed89c78ee71b0c1b577edf8af07e41441d3fa4c2e6d3d98197594780b98a7d286ec5ce54b9020d0467a533f1011000cafb8005f207362fd4063b52fb5c16ce7fd102e4c2da9701f78363b0b1ffc115c8bddd9ead4db65a0053061e8a713dd32c6cb7985469d082613ac8892c89870604d438d3289a51db1800a4386900c4af98f9fa5900290c3be016205c6e393b7d5ec6c324725f06f84f7793948ff861d9f4455d43d290441eac790645a7c39ec958e65e937878c359b42c3b0dde956a1c871687659cf692de44bbba78dc55e29a40965c26abb98a1ae5cbe4fd700ebebe89117b700714874f5761eabf43b3069eb44dbfb68a8f76125a12001845e3173b3da0a5bca4f84bd8a748c8a73f915bccf455feccf0e3358bba3e868af406069e86b08351d8d4cbc0f40bb13d847a650fd9cd7c41d40bea295a6fc3f6c9fdf35258e8d399a1e9ebd7064281a12bb2174946d40992928c27f313122b2ad6030734a73cb54ea010f2d0c690385855db2b76abb4bd6f9fab2d27d40158820e78b890abf968525a514471e7111d579a1c0f379d9ea1eda85ba03afe4ebf5514dcdc50fc63f323429d87f3ae207aa19c795f97f36251ffab2ea16dd2c6dd2dee10c58fa1fb2bdd50a694c18b89776646b835603b203b56b53c823e63363ce45f415489041068a10bb9a1123139bd898645432805d425046d2d35c4d9310bb2739545a049324c7aa517b87e28a7b61c9302d1f1d47f4c9fcb7523a20a3d5b9d5cf174c147f09ac60df41fe87255c4c388a280d7001101000189046c041801080020162104ac211461fd9114a19e365d4b2314e28610109fd2050267a533f1021b02024009102314e28610109fd2c1742004190108001d162104877dc83c2252458cac0225125c77de7bc1f2aac0050267a533f1000a09105c77de7bc1f2aac0305f100082b5130ae96f2d331848a000bb4a6f00a55be22c752cfb141bd358f68ca4413ffea486befb7f83b00eda23425a33e6b27fcbbddddc11cc6a4ce9d827b9c9609c8ce0846f0bd53e8ed78cbe51ed0c8ac04313faae41e477ef76c32c8b6da5f10ef73ac5d0b0fc23e770e14e98cc8740131e831d3149215c61c0151399a5928fa4e4786280d4ccfa11b4b4130b9a9f0b96d98bae5a40d6a996dfb096d54ca214d0c1f6a8f73d05edd011496a91b7a8038484e496aca3aba48b73a14f94e048b6b10ff864978fdffce84aa8d7e0cb6e651f1051b1728f97d7e6ffb0c17cefd98d8b3347b1bd4118f790ad95b9a37f8679eafaa5cb92156d1c14faaa106aea8d759e0469f9533e7e69ab217923781280a395c3fb12aeadbba9bf1f099d03dbfe48ca997a93f371453882c66609f3d788a56f1dd5f148f37067c6c713cd77c2f0b663fe161ec01ae1446f3ed11a2512f9e537cb4cec2d3451f7d86e7d77be81261b4133dc737f48f2067ab17d6c3efa1be07274e6f40d5ea4d8e6d2e17e0095d03389bc113058570a3ce17805d117a98d3f277392007321391df13a656db7e6308f7b55dc1cf28be54c8f1eb87a56b9cd818c88d8f380cc96264787ddd294bb420486cf670848e52b291a308cb2e93421384a805309c843a875a7b633242a13390981896d75497e31c82c86f7dbc34681515cfe18b9864339f116659e54736f712263a13b0fff6554606b1f9ed4265864916959582dbe5f2702c075943e7778541a403ed6c7215897a2808800e333d26a57f0d1a58af541417b52e671ffe0eade1ace62154eee80aa7bace3b576f62900a97f417b1ed04625d8d29e36a2095e5b756bf69c5326ea5ffccf4fb7ac8d0c8ea5fe1fcb64c5a154fbcec39393aa58c2a159ebe76c4ca7cc0b9b57fa3a34d5b1b27ef337202020261df52c0b67da436ef9b0ee758fde8377feca3cfa5f84eca8be6e1490b42cb76ad57ec3bb852c09ff2e0c285287f432254f8f8ac14e4b43f42d83354d6f797dc24a1bef974d0f8b8872f43c28fbdeee52b1daf4627e5be9ea84a28da6a33aec4a8fee3de8d15f9abe1237073ee4ddc12b3b0e557c838a6889596b8a1c6c070fcae728bacc258265d70f0e978e2e2dad87e9d319238525ef762f088c435eedecd99e29bdf890b94240b0e6c4e82c13427af81a1e6eb0a70d7988156fdfadf80ae56becfb7b26d68d0e758d6ce6d23f70085d277dfb41328fd16477a1853503a09025d0089229e290bc4f6ad259350c9dff923934f66de74b6b20fa5492fd15d389afb95726a2374317309446790ad569c9d9079888e933c75a7da5e3d130e913326e7d6a950f1957b7024a1be1172906ec7552f0b14fb7a7a91e9903bbe73862bd5f4745ced85580e4fb5371e98f51aa947a64073f453a70891644c4d78ecc7bcae16bef624078e49dd348bfe2b673b9020d0467a53401011000bf996ecb0617a070716c64442b5a529496ea45acb9a120b866597b4228ec7a1082227776f39ba779b6bc1dab96f159de32748e06326a10789d3b3ded3566a5c554836d60670c4dd332c04028b26fecdd106e9e87cc3d531cd468db5a265a81093b73afe161dabef13b548eb14c9fe671b1ad389ad21676824e931d7b71bc12aba5c4e776f7daa7132be63a96850a8e466a08f5057c5028272c3a530b71ed2a20876d1022e86cfe63b97afafb84deedd813552a7d686add0a6328130f7b47373d87f5aa8380afd49be4829883335d486a4864224f0f1c67b085413f09ade3f55042a7953f49d01af240fd72d46e195fb8bc30a28a7ef2da5fa5375d8547f2d11663a28e8f0b2e8eeec20d4c6d5424248e84b541ae4622e1d25af73b04fd3796b6f86657df7a8912712e7302144e8e7cc78857a2602d2adfccc1226938f2858d23d7445526661b2e4b61acc3729de8799b0dc3e768210cf6673587434682b2edc9e8bc9d12c0e5726604e1aeb2289ab44d6e838814ad2a4561a0705c50f11f5280f8a4f5e6270e473bc47f0d24c9c8339909902221e5460862d835579f4114fb6e20cbe2e16e05a1667dc850a27dd667ec15cf35e4fc5802eae50b884c985921b56de9c4a717db39b9b4f6a330b418560e0b310f5dc8429bf74f21a70d371768dc8df9343bd827048b6159122c5b6fb35a9006f9abebb2e54375c12bfd12642341001101000189046c041801080020162104ac211461fd9114a19e365d4b2314e28610109fd2050267a53401021b02024009102314e28610109fd2c1742004190108001d1621048b02bbc580f9e9fc8cef46e23ecbf13519fe619b050267a53401000a09103ecbf13519fe619bceb00ffe3d5ad70b61914fbccd0dd469cb743523144fd3ff7b75157fff9bef47020e5e3dcfa6b686f4fc9e77a17f239a36636569db205980ccc0e14200b43f2181c6b7ca58bf40a1885c117e7bdb40e98fa7859dfc83ec5b99d0dde67e1d841488b9f3306baa8f47d48d18ee195b10fb9aff23be0e653be962f85689e5faa37d6db0212286fac46b05d1e8ec1c3237d3bf487128ad25dc658f97c0f6bd8b875bf5096d5598719024b8b839fe785ca024053aa5de49000bc3b0a93c0acda0dffde160164770720191edb0bfee79a8a417b3e8d0a5eaa6875ba28277f8c8b7ca0b71a69d02c41918a92e478e68411c0fd3cfd78f62eb53a70de6581dd8fe188f1e59fd68c37bf4e46c333b44ea705f5bee159756af065e0804df4bde104ea8b73deb8ffbd1f1c8d55131159a7cebc831d1b1b072d06f2a5b77761534460c392566de0e480bc60ef6187afb39c2c4167599cc6f3ad3c3a49989d7ad5d730a0a9f653d40aa3af4acbc86f906cc011db22eec62c0df10d2cacb50a5546db3384e68b9a0b90cd6bc25eb86b5a5096024f2d6363b6928ad308e9bdc2e7183d45fcd934f06eec3d4fb0fb88acb1690103495bdbc490923e5f98327af10f8aa5d9a13b97df176d0d7c0ebb15c8476c644da189c307fb66616d60fffea3b2cf07ce0d0db5152b5c8b34c6ef46878905f9dd1a2f1b5012a77daf818a81104586d7596f3628274b1e444eddb0fff4cdd98b4b2196e44aca45efd6d86c03eddf86b4ecfb5571a62f866000300bf5e640c0f9d21c0fea601faf49c2f93b2fec3140ae174eb88772721dcd0dfb4e5d37cd00a72875e67d74688c2f510f99cc2ae12cd5a2054d7751ea6452309f93d81b8abad5464572a3ca7e79acf248d9ce955ee0f366e85de85796c781bf512917a5833c0507df5bdfbefa43a2f72c3b75e8997ca7d2c12583fc5316b27851d54326285f6e7002bf8d20454e0c0a93dd73b50ca2dd1c3844facc2e8c931e66caa4c7a63ccd86eb683007071116cf61eb2abce8bb202ec85eca701ecf74d670edf0722ee7dcb99787328bd821e63e9744c9e5a3253e9f901b08722c1bd64698bae25a089ae854221c9e73cad343d5e8903a63d5e9652bd1dae4bc19e8a8593fc807e734b521d942fa8bac7160874da7677792a8c30b296092acf35bb3b9f37b795a204985a7722dd3eabc0f608ea8b99b07b9f098e2263de15f63c5a406b33076b5b9b9ace93a778f2a5f1542efb55b9f638ae2e756db86bf107d0e0d98beb11422a197ad906ef61d7dd0b169f57b82443b194e4c86f350a2450bff0d4142cd7c50d9b59b11e88d03912ed9cec293bfca6258d5f25b1ee785b489df5555c2875a90c35ea72237361334d1b3feb3dac85c12054052e6e282d6bc92990373172ea410fefd8957ae2b336dfc8b24db26a274e38deb85fa309a9dc2cc7642ad2a59d91a4";
        bytes memory SUBKEY_RSA_KEY =
            hex"99020d0467a5365b011000de53fe1d80b225349388c7952be8e844b4d2810c0d20b30e7d4cbf15cd768f252920e0edff9e363763a27bb3a5d614750cb6587318aa4cb5bea5f227c47d4b5c2aee82ca93e01715bf3d6da6455058f8d0d7177632f8e448278964d2ed85cf7ba2829a7f7405c89b8f3f695759cc05312f5874f7a3ba552473134750564988f25d5401aeeaa48c3061987b637d9858b367a9d42f9a0274f859b8e1dcab020c0a64cf4b67ab33c7faaa9606c6a8856ccc607f284373f550618054fadcfad315bae3cd20c0fef6a5e60a12883af9562b59a54e036801bf1faf1b520c3a85f87420d6f2f74803727a18c802c2f9bfb88fbd2d99f7f25f49be08a60e66a952e9896f0cb0d1da273cc8da4bd41703bea8a3e1890f55ab50fc97571cd7da91583f5b08779f5fbd7b4b58076fda4734aa34252efd59527f8992e67cc21ceb4a334a940490a68deb793caeb6614b67378c7ce9afb1fe96b820d6193a5d64ca044de3277b3af4d93a777eaf6ba57fa58514195d9235abc75294117f5b307d2d01c1200541cde99e1753bdbc3df6089764c0bdc5648e118f31d10f818cf5ff477310d3ec9e2a353eb9a501fe840630c26c58d6fd0c206f0e8886d6acceaaeeaa0fce63cb2079e8517e503991200aed6c0ba79136cf78a842360d02fafad0e89ce6ad228639b1e18d142d347a2e36f8f43c867c2ea53f6fd3b1931aa0374678da112b4c2ac30011010001b41c5375626b657954657374203c7375626b657940746573742e636f6d3e89025104130108003b1621042275f2b3a66de56b18849bba1f1336982c96d43c050267a5365b021b03050b0908070202220206150a09080b020416020301021e07021780000a09101f1336982c96d43c67370fff58df0a7915ba7175dfe34ac985cb908f484097c0f396972d1f1cdafc0de1f9a07be782f700663275a20a2d44bd51f2efb4d31508403ec58c229a307e217fa5b4cb32e41e6521af8cb008ee10094aaceb710de871720f52e6cabe1ac096e84b1601a8227643939b3a41baa8c767cedf86cb5135766697a6643ce3420c8cafa4cb70a7a17fb698a9f2e5a2f4ea1766884146dbc71be086a04d8eaadacba378adb72037291b3271e7b12f804a46687c87d3fe7b10d21154c5cb94d0ac13d4a5d9a63220259f36f33ad0486d722c8c9fe32cc8f8fb34b6a19ff8de852e15f2c6afdc5bc80526bb5bb7511b2c68c5b52e3317975352c67d309b6b983954dbc8cc272130df0362a032ca551d06e4a68fe71caac1939a95ac8be70373364e4050b4a93d75f861d8726e38ded1462e192e706e167913733005dbcc7b1152ec498c408831d774d7ad9372dfe9eadfa4f1682a3edc837915804666e3f75c0843ea11b1e9529e74d12930a8867060b8e66379c4fdf51c9b75ac2174cef478f0b798ff968f5578114a025363a130329692eb3ef9b0e480eae474423b2e873ff4f870edd22798f6099b5dd574458dbab95b59daf84945d32d91852787bc1d3149dbb67ea0a9bb1f01f40d748840f123ec39e08032b6b9d67af0e0d02fd9c7852f450779cec348fe8273813d53c8fc2428115cd6c535cdf48b432f61d15600c13b1575604700c4b9020d0467a5365b011000a5af60361d67a7b02daa010684a14b4e9c890455c706cde5805ec69b5a586620213be0b659fe25cf3eb25ec0ace04223accf5684c56883cb30e2062612f041b186927abd86f94aa9d1f81e68252e2ad22d6d798b51ad692fee8b0883d1f2e8991d60c80dadbd29eea628e3a8514b1da4669bf9e109dcfb801ab3808312c70a4ef0d6c721ca91e6c498aed08b6683672913d755f40da162005599129e4c82f91d8a02088452bf1553476aa4d3fe25ba52e229b2199e938e4499dc003cb8cc4ef4515e5805fa937d9aceb51f80f53f19a1fbdcd6832a236c41386155e30e526ee8fafda1d74df3f20330fbb4b5f0148b277f501e31422f03aa81ae16b6707ed6953799ca6c7f15fbd83fe28a00a710e9086b3ee254523e8316c7005e4fae7b1dd70fb854cf12ff03a0b32cb208c71ff9f6453b8c9e1499f67579a48cb0954698f868d7bf870392b3b1f9a56567fab7109901c2b8441362b717c43ef86c8058a46e09f404dffebdf6679a439463b145d36af460603ba83e88f01dc9a3a6ed95ac278ce39ec95e41b76140c523f9a339cebac41d1c838028c73a5f8ddd09ab6a707a65802c7f8dd7dac60e2906415d7ac3861c5cba640ee211957adfcb004f045cb0f943f227406294a07d37b76cba3cfef4ef31c38bc80b21d6ae00b5121d561fc3024b1b17099768679eab151043122e923ba32f0023c972c00a3e962f80a6667300110100018902360418010800201621042275f2b3a66de56b18849bba1f1336982c96d43c050267a5365b021b0c000a09101f1336982c96d43cbd5d1000c0639130d86ea1dd3c84fd75c1d28501036e01597050e96f506081046b544628fe2d71b3e66ab7f76d60b7be6b0ae4b479b46aabb72616ef05175ad2f997ee1830347a1d8aa5dae3b98518bf290ada37d44d17de4ace7c984ca2dd6cbc52502e672634106715f2f7dbca992519b0cc89783546e23a91fb27164ba6f18d9c5ac95079ba1a9fea9da5c3f8d9e2185738e6fbb844f89fd8c463d31942b96cecad329545319579910855646514e04fb32f13015707877ef8ca52f5960eaf71b54146e1422b02c48e3a4286a0bebbe02e12ea09e7e312fb612cfade6e9e1914cdc0c85e51353cf668acb3dac5ac37e75b7ce9d12ca8a9b5a61190b52d1e09a09d17e540a8d4a27d250124c46433bc27cacd9c4a162db4ffde2ce0b97d6e07be36e996397cb8ecfe1ae8215c65ccd610fa51b00808bea8afb33078711c39a1b70a346fbe6228732008d4065022482932f8b0be8226beacfd9cb447e53daef2caa2ec7c57eeb9009269aaa3844eae023cab15654ed286fd01a5fae691bff017cbd29ed57b7c33102c8a0063e41764def061a24f628edf20c14ed8204b926a8c4798e621efd7b02625dd526ec0825f55db01652cee3c874f5d2bbe9e0bf2fe64e5e6dd3daf8964658e1c57c563503c51b67e184c1fa2c12220705d93e42676fa48fe099464b97963d2a100205a5908e83d413b1f15a20d720137d6e6fbaa5216aa7d3773b9020d0467a53686011000cee9d3597b93cddadad1ec96c6f31e65f9ca798f541a3f3a0f67745fec44425cf1c45baa9f006b4267e8dadf669fd6a4b7d4873a2bcfd4d8db34070c8a4b44106388c13f3d0f922cfc2b99c235787b515bc5d15d77a92334ca4748de2c4690fa041691e3825b02b08caa84a8da174d1f788ba9744b1d00dc4deb79df0fcc4b1613fbb1ec97b32ab4f96d03fc364869777000adc18da9963687741a9fefb203a4ccccc34f133449903d22872d71bf6f1ef51d506f7bff07bcbda680a88b4933b454ecb2fee298becdf80267364297d0e953c2704b7ac7db64035a09eec27d4420e2c577ff829a816c13ae87332438aa731a88909c3f41a4357f62ada3a188c9f92dbf3137decab1da0c133b41db2f01ed21d8aedb973b164b4b9aa34227584c9fe0ecec078a4d270dbbc149c05abc05611742783a195fd508ba22d4346873d709ecfeefe63a738164a2519793bda0bae4bfbb5f5bf1347ec8f68bd3c395a715a5f6d981de0af45c8d5deff5fed0fa98cb7f2a4dfad623041262ef99af96261ac69c4ccd99274917e827519a187743c9ca8027643681d45ea472e26496dd7616335df2b64c476fd11133fa063f459ba72cfd8fb9a15f6634bd72eb519dbeb0b47cb21c185a932446d8a6ddc444e916947cce5c6889db2eab0695b85798adc99a81b8fbd8624860ae78a61820ab7a8c4726a99820b07bcd7c3340afda0eda8ef679001101000189046c0418010800201621042275f2b3a66de56b18849bba1f1336982c96d43c050267a53686021b02024009101f1336982c96d43cc1742004190108001d162104bdd7524d6637456aa1f11ae2a3c026794e632576050267a53686000a0910a3c026794e63257635280ffc0c56edce184dc9af92be8276052d906df197d03e9a29c4b99aa77c3396ea4b2f5ba23e2c7085e8345076168bc4efef074c9ecdea5aee6ad2b67b91c7816c7b0b336fc1979a2475e256eddbd07d4ea35a8bfd41f1bacdc5d8914f172af32e4e7eb34cf07b6457906a52cd7c7c0dd84eeee0a97e7a773c418024c605d94d536e6e0b3c206fad47579d15be75d7e941f0dd6ead793656f38aef2c15fac35c4829e4cdcdfe73c471cc4367ba30d51c7e42e22f94e3176eba8e1e7c542671d627b37bf35401bcb5d3ec575d6778d030e00eddf02729acd705338046cb4f0d80e678d9a37c9e53bf6920da504b0be75e016d9bdd732fe5bdb964a480977e7e901d730633d98965c4c71f23a24649d4434d08f0a3f494b413f43999c6cf1c289c6633716ff3ed0d75ca17de8c9b5e23e16303a791d5c0339c8756a1341cdb1942ddeac6e748094050547c8887f0b0304a923e2567071bc5867bf9ee6a9b4d986a2dc828b154bcbd7341fa64466aacfd29d3f912fd8d92281a7d2f9d56b3a91f983d04bdb3fd21cb6d0c02349295e94c92395d4a8cd84281d8359fdd9b42209daf4b873ab2c27caf1dda54c580a43d92fc94f4bb097646326dce50191424bcce26583a80badabdfc6a84e556aaefe816e90888f185ff44c2fd466d5b3613310eb21b4f37e876dbe30c71e53e76c79037f7d556f704f65300a90b5611221762c0c1b9e172b0fb1000d7a8e27fd78bdd4236de8763e0d5985f6ed8dd0540adb0ee0202a70e5508fc26ba017a30d3af33d397c0207e76b596d2c011306533cfaac0d44038e33ffdacfd16083fb4db5cb421e218f25e967b6543fa14ce4a863aab6bc5cd9b8e417b5f5f0c97d3a6d3114acee292f080bcad074e763d460d6f78744888f4e5000090441e3483dc026f04e9ab18e6f1fa4e2ba0419cddf491f4eea90e1bdb1015d21e06316632dbc800e8e1057629d0ebe228b045a0738a06a004fed0ec14776b88c587e2bf9581eb606a2b519a0f23e882485c1443f421acea8957661afb45be90a1c5e31c3815ad73447df460acad886678896c5dcf7bf37e5cfd1ff5291a358bd98a3bddc50131d951d9be178020fa0f7cf3466b81f63923d144aa10e93176fb7bed4522fc491d94193079a589d9bf4c4f7bbe15b2b9ee3b4b545a192da45267beab6a9dcf7aa4be4801c491b7b36e1633473f10621dc6f83ff548616b0a0b8c56f29bb023946e87cad2fd5261c5dce488d204d7d3d575492ef1d84e9060bb34c21c0ae1bce45f166ba2827d12a6d11d82afaee6ddf82c28e981c4c56d85453ff2ef05cf7a98c621bb432cd6ef07e72efeb6f805efc1f92a7dbe4bfa423e72c14ad91c556ecdc30040c303e5e7e104f95303fe8502704becf6f7e8e098f7ea4733c35e73e1ce9337ebb215710b98708bd76bb3546654b9be607de589b2115bca3f6224b9020d0467a53696011000c7c96d3f6c849f93c3d2188f446508d6bff4a4325813ae266111fadcefa46c09f60e6357f01e42bd4456c089deb9c21a472cfb208f8673ecc449f4b79e2fac27a58e7cb59bac72adc04007c005e6820638e6363bb293e5ad39ca35eb01e00f8d82b470dfdace950fdf7dbfd11b77678a039b9d34fb5639f8d66a66fca8c99cecc4cff17c6256e55cd5f2db6755d40624e832a8076cb3688a04e0c9eca1a772290fdf6b8919b88680601d3f5075f3b2521d30a43073caf1c61371d3a8b42b723dbb3867f8fb91f4664b6e56216bdf9ec86a9f533d925ad022bb7e06cd6e7ab0a9b223c4fe9b0098596b6d8a1bc3e12703cae110823aa44f83d720a95b679fa5fc3b0ed298f8a52c8588888dd66c4bfacd0cf6b53c39196f79cb9947f8df3f1dae5bccaaf559a4b12031791ad171ede91b13a2b2bb3e859bed79320fca0e4c94455d74e14502cbf53b0d6628c4f72b5f756e5de638a7381d87319222928643e700bd7166270865eacdf2e36d7b813b536d9fe2620e891b2f1bd30462224d841905a1618f4cf2323875cd75ca744c76521eaab5e2d6f154b8b61f0f3617e33c1cce665ff4234c5417c309016f68ac1a91fe0cbdbaa04a5d82b6116fae17bb9fe00ddaad854db55d2338c351643dee4bbfdde2efc56aa3b2eed0311bda2aebc9f840b9a1848053af29cb1fb365be7fc471eec44ef808d503bd02f94c25825fd9b449001101000189046c0418010800201621042275f2b3a66de56b18849bba1f1336982c96d43c050267a53696021b02024009101f1336982c96d43cc1742004190108001d162104e6e5f51daaafd7c22f3466e725ae2ab406a00575050267a53696000a091025ae2ab406a005750ec00ffc0de0610d168f4489c3cd2cfa2a3939b0d052ee8dd32c655f036e7d7bba4350605d4ac45357fd05c6d3e02e995c5816a02df3bdd36b615969701b4ba94e6c6337f4d4b2be57adba3537a6df2b9217e00b1a0d8b6b528a3cd23d0e73088b2833716e65aba20e4facde61943fe0b60b34f6a480197e572355d612d09c8d2ce8774ff873d07246e46896a291eb08d87afe8e536e51450617c1ae9bb9f62074aad3dfbe80ce6500895e7b4d6a8b4a07ff3f7975ad61532b1d51c806faca246315ee05221d3820a081a85a5749adba7dd8577cc6cd225e303ea6ac4f547a3890b88337d3b31381067308e7182a3d91b3182ba5c67975c3ed793b996c9ea9e4f61f30078061a909aafd264534d1ad97f95d43cc00c3454970fcf491d2cb8eb48e6f0394fd85968b1cc30cd63287a9410d2531a76ea31e3e10e8b5045cefba6fc6babc3bb514f4d132665bc600088b8db7f4b7403ef662ed6d06054f3be808ae6d731f967935751428d5e368e64b3c8da166bee3a1529029e5bb566ce2e06348cda5c7b4a45527bd497cb48e95b8172aa6c2cfd8c6d7346db817dac4eedc1202f88eaa461dddca7a95a7c5adc4dceeee088508d15363bec2e0cdba44d8c8dec43dbbc2f091f3ec1de83ef67dbed365152f96c787a7a15b1b12817de499a2562f638acdc5ab50ed519fb58e109214c34b0913c55021965e57ff096ac033c9d5d4a84f6fd197bd0fff65b35e28df2c2d01b66340244e0aa618b0aaff2ba0156cf3a3a0efc9157be77b1cd44b35b66427beaf93fcf8e5bae81109907c195ddda701185111fbc9749a89d13b0d2c43b7354c33d74ea2f4b017b7696c6d253e0499d768748682043a4f18ba3e18dcddeab03d1caca4f87974fdcd1060e083a3174050ea44bb1d984b15ba392de4452625b59444960e32132042f2b5a08c0f0b46a8b92a7c45d2c0014e4bfb1a0f32fe1d6dc72b9bfc5496570a7f70c13ececf00371c3b94e46dbff77d885aa652826bc6ea48c545443a5a01775025208eb956c71e83660039fceda169ec60a9b41deb183df23313ac2c169811fda66b0afa83b675a7f8aeef12193fddbdc2c260df1e4a067c6d7fc6b7ee4256b47025d2d02b249b8b8ee841c268974b4df97dff44cb338237c978ed233bdba78448d933b01a8719b0b55403781a289858d7a7568c35c2d8eaa418abcfa241b1b30b1b8b65b80d7de4d62b2a62ad695ab1b64dddc6868e3aa9eadc11002e7bab605d825463ce9e4804ae5d7fb70a3fa612247b6b80c6014b1599d373ae18c193fb461fafad73c176f3df4c02f4aeecf0f660dccafdcd014a46a0b670c05e6e10cd4fc963fd6e91373b647dba9e5cb5784f6ff26837c9960366b14c4e4847645cc9a5d55fc11a6b13b90e4fddef51dbb550ae1f56f3eb051e9e5be07bc8cecf9bf75855b67b8bf7a33650d9c5c493eccac2b9020d0467a536a3011000ed0c0f6488d329ffe7c56d875a65f64c3ed138d20f3c0968662518934cd90497ef4712b40cc3b275183420bbcf57cc5e8069a817cd93f076499a6fa871abad70e8c9d027f39e59b144b2b31fc5dfa6cf32e2621962cad2eecda41d028082e473e062b256281789baac6d095b5f69f091bd6ea681641c29b1e48d5694cfad1a29514cae5b37559f8d70ef2076b8ac85d881294483dae54db9578914df09aa77a100d15bf2f8a81ea441da2ffd8bb4a35b802f5d218404f4b5a141b571c5e45ec3a0a959d9611276bd5224363c3562233810a09932c4f2c9f55654925b4ef920d4ac0b169d65957b4b76ba5d3cb66f969eafb0c5854c0e4c5c76bf0e4328111de2aabfd33079335dcf194138165f6c6e5b5e3f79c076304b9fa3b21b27b8ac8498f485dd7cb518c8d87982b633984ebeaf70da8a979ce15465204fe8c8bffccd9ace5b829ff1b251169ce6fc12bd0cf443d076c04fd0682811f8249bb9ba43b02de50f96cbef0c3a22a3b21650a220779d63f2eab528eaf47f729ad127107931d0d072a81ce25999067db87485241573f83c862cb9c7172af1f8ec2c741f99b42732c4615af0fb676cecd2a22eac0b85bb2512bbc34ee7fb0e81be014f646ad4e5a4554ab0c20f8cdb06358996266e07a6819ec256a5aa596aaf2d075900491af80b6f70f11b4d99eb4e7fe1af0329896944a1acded7f0075f1d9cb68493af531d001101000189046c0418010800201621042275f2b3a66de56b18849bba1f1336982c96d43c050267a536a3021b02024009101f1336982c96d43cc1742004190108001d162104dbd9e9d685e83a7d35d7c5336e8c05f4d78189d5050267a536a3000a09106e8c05f4d78189d50e481000d8838cfff880883391295b0435bfd391f634087b8e74175ed5bf90e859c24cb1c59efdeda5f9c22be4e162182e5e2f446cab1ab818d0a784d62a36a748e1554b627be6398e1748cc0cd92d57849f1e022c9c44d121e6104a4072d7fe3661c8bf42f826b9fbc76b82171b3172bf216964ff50e6ce834ca2d8754ac20c326b29a20fc3357be80404e67fa4021c2f254754b662ce99b4520d0f035f44a8422b63312aaa67f5b424aa81e6097af5892dd16f8420d038f59fa4824a531bad166c8ece32dcb8bb211534f2aba80e8db327b4505099e06c79f68861d5b09550cfd3c4dee628ce606c0bdf5818acb1c5cb75b620f352e6e2ed8cf0fb1340ef2fcd9653cf9cdf17671b43e3c2356a68938dfc443f00b336b26576ad076a9e4751446da92a8a3b75d3ca26daf187bb48befe88b72f04a65d6552b127651a6722e574b44ad7ae9d5c0013a431f8d0393abab125d944bc55d6fb84abe6fa047f44b630c03846cce19f33e3c4255f37f849f1aae7420930a4f50bab863a84570cbacfa049da2a70ba8fabfc9328239a0e2fae6c441a0c3a34f3806b3d685c2d90177d2f58a5978f33b4a76cc8a55d72a133783aceaac37a395b4507c1adee5a7dd67e9fc09c53937732b08767689692f7c9dadd63578cc86a8ed0762764a8ab110860ce65d9ce22312747e8b358941b87c7baba639409dcd313224c559c20f77b34fb4cbd1dbdbf590ffe3d506331559529354f5d66f33f6fc4fa4244327be2f50dd1d10c89ab65ff9b4d6c2dc5b9704ab369516b5cae4521d490acc79863f03730a33cab833a066002a360bc9b498cfb88ac024f62409870193c1269b250c57b2fdc3a70703b9f134384e4e34b5a1eb6a66f2e2937ac9c84019128252faf3bf6f6fcbb8d7ff264a816ff92502c64ecbab45ac71761b8c0f4151f37f1525b529c768696b5d373f5fe1bb00739fc9b96826969b734835096c85e8b4c53e610a14425e0f8265514e10b58ba0f43bdaf2ce5638dae145e0994c93ae76325ef96f76bba8328b74f20591cb34750b414e7b9abdb2fa139e4d1ddb5817340f6b6600114183ae561f068a1c5a27bf7f594e1b5bc6d7380d7bd93c165c6b97f5de25f148de58db8979c77a9e3ad050071a7826c41054974f703f26b799c42321cbf7d9e9afb625fab958fa665f92b402f6e4652aca5e99ef8b0ddc88246f44efaccf3fd67b556a2ff165e31d67fea11a45ddce668e6c8f35fb1c1a54d8879fc8edd320692ef150ff37b39dbf86286555a270cc341e484c97b5a5e2f11f276870d3ca334d6a29aaae2bdd05b4db6a796517db5ef67517b4eb29cbd2c92e90d56e5d277c9df700b0dd7a9f22135d87ad3df7c2424b1f153e3228db5faa05a8862f4f8d51e2328c474e98cb7ef6737ed58d5ee2c3603dced8f06021afe76e00a0ecc7fe43bf198e12707526922b1ad38";

        // GPGWallet wallet = GPGWallet(payable(deployer.deploy(RSA_KEY_ID)));
        GPGWallet wallet = GPGWallet(payable(deployer.deploy(SUBKEY_RSA_KEY_ID)));

        // GPGWallet wallet = GPGWallet(payable(0x060DfB664769Fb9bf1369b01D92fAfBC7c451BfC));

        // ED: 0x5af06adaf66d4711487c062b6d213c163973294ff7b0d532289274c566b57bb4
        // RSA: 0x8d36183ef046bbd47bdaf0974f44afb4a4cfe0ec3b63bb1b06338f1bc0deb097
        // NEW ED: 0x07adbc1ca4be60c519f60e5b035e0ae0d1bdc1e294df85c64735113669e07cce
        bytes32 structHash = wallet.getAddSignerStructHash(EOA, 0, 0, 0);
        // bytes32 structHash = 0xf4c87e03710cd61431a6b93b4ed17dcd431ee8d677d882c2e3993633709fbe2a;
        console.logBytes32(structHash);

        // echo "{structHash}" | xxd -r -p | gpg -u {key id} --pinentry-mode loopback --detach-sign | xxd -p | tr -d '\n'
        // bytes memory signedED =
        //     hex"88750400160a001d162104c4e971386f7e24899b765c6b49ceb217b43f23780502679d4c8f000a091049ceb217b43f2378168000fe366f832ebe69273bda4206513139501fb8f20b21d86d06544233e580cfa0f0870100f173f30395691d3d25ea59118fd0717859c726698ed2d9623f94815debfb2a0c";
        // hex"88750400160a001d162104c4e971386f7e24899b765c6b49ceb217b43f237805026793f8ab000a091049ceb217b43f23782ebd0100d53ce67418f85905dff75b7eeb3740673a784952c36832b5a682c20b9e3111f100fe2f56ad2504f00c83d599e8e6a924f8550315d01f59ab6708102572b28be7fb0c";
        // hex"88750400160a001d162104c4e971386f7e24899b765c6b49ceb217b43f23780502678fee15000a091049ceb217b43f237896b40100f52ea02d10938943be614b37cdfb88e50747369bd0ee9fef045db0ff707ca90f00fe3e44932659240c78c30b880eb479a1e6dfada998d7e6f8868ef00eb4dc3dd000";
        // hex"88750400160a001d162104c4e971386f7e24899b765c6b49ceb217b43f237805026793d29c000a091049ceb217b43f2378221b0100f01127f4494ccba47c7c177dfc84fd37e2521e4cdca171ff68220a36156d2a1300ff5cdff84af9d791cc03bf3d1098c97f858810d4858f4fed7bbc3c19ef166dda0c";
        // bytes memory signedRSA =
        //     hex"89023304000108001d162104fd22037dffd75189a0399b084c4c3ab789f86a6f0502678fede6000a09104c4c3ab789f86a6f65760fff6e9f5a7b79b0a6b703e0b4ced6677461626f0f8dbe59bfd2c3b3b8db53e9077b972c1202567d2a28817e0e4f0b6944808aedb0b430c606c7267679bdb97c3af554684cd36065c84567e0c1e9c4a251f7de89e4e7c167307a29e3a63352243d48fc8d7375b861462e03a66e7be075edd1be586ef7c27bf634b96b9a4945d67504f29b3fa2292de37b6680829cdcd956ba11b571311adaf3598e145eee0ca1612f3a7014005e6403d231129d03240bc6273e835ba227bfad89de650fcc63f392128080a3f01e8b51f9c22ed1b92fdadb9581292e26e582f2017c5e94423a6f804f47f280c881e42a776abf26ddbc4d5b21a23e88bc78c6e1f811a064e5e5d4f77771518d64856eb88fb55b7560441ac1f99abae48bb3cd172e4e002f4297fbf53bec4b131aa9318e5b3811738ba885bd76b99368eb706380603c2161c1e5efb5918662816b86823029aa3f0a7f0159922bcb1188169d4f4ceebd0b274f210a1adbd4f8542800c3df8885e9fd55ec4d9af9637d944d99c68b37e568c5009bdfb63e1e6900bc55996150947b31b18bf2c4a8eea5454c67767f50371a0702ca8e26e8fd74076cf5a0e149d890537af1afd06954dd44892768145ed92dc98012b1ef28101d2694afe511a77e02caedaa9522b0263adbe9cd188222f4dda3db15c699d04148f3706d92484c339c12456f9d39f99d7e2d0b1e4f21152f776d2ccaddc1bc";
        // bytes memory signedLongRSA = hex"89023304000108001d1621048b02bbc580f9e9fc8cef46e23ecbf13519fe619b050267a535a2000a09103ecbf13519fe619bd65f0fff67b8a0dc7b693aad6f1609b2b9a0172984bc271392d515e46671e29d64f2680ec2af981bc477ef75a0006e11b0d53cc42cc2e60cb7fb2baf3dfad9b637cf3a5550f4b9e2199794e9da1821530cbfbbd3cdaec58579057ac48113485e173e0595e091b0edfc422f7de344c25ec903b68d91ceba0aedc1f73112304b391724c57390b55fff41fa498c8ff9238863057b589af6dfde074790d400dfa5a3e9d7f928a511cc55b2970c2c850b93ba2871a9eb26d4242919ae22bd599fd828f8b90d15fdf353f03d2de33fe1ef44f99ed30d6deac7f926e991892c2ceb9c307f248b66500f6d96b4b1153d283d565a120930096445790d74779ac422f369d0795d8b05f1c3da4720a21200fc8a26121944c9237e1b6a6c485abe0484f2ef2ba8558cef338c051d2386d67e103b271c54fd5d8879cb85e96cb10631619808e38a32698a9be118d1d1beeffe1ee54e029cc0d80b43c80186b35d9d595c94eed14ae4bf2066fa54d2ec21246ad3226dcd014b83b5856427a10d1e9a437585be2f997bf8a6e198b7c744f979af9356a2d520f79ed4b1f63ccc17d190261a329972a4487a75c9fe5d20cc97f6163adb880e2ca5d32fda8d3cf5136ca3ca5f1e4b7e6ba5006440271f621cb63f9045d452bc0772d6f7dec3a22b53f8eab6dc37c574a29f5522db6842ffb7105544c5f8ca2326257502d2ae40d0329907efdae919cb177a913a";

        // this verifies on the precompile in tea-geth!
        // console.logBytes(abi.encode(structHash, RSA_KEY_ID, RSA_KEY, signedRSA));
        // console.logBytes(abi.encode(structHash, ED_KEY_ID, ED_KEY, signedED));
        // console.logBytes(abi.encode(structHash, LONG_RSA_KEY_ID, LONG_RSA_KEY, signedLongRSA));
    }
}
